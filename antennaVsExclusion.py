# Comparing second best Antenna Factors with 50% and 90% 
# exclusion distances for PyGRB Workflows in O3

import statistics
import matplotlib.pyplot as plt

# GRBs and their respective offtrial exclusion distances
grb190407788Ex90 = [58.0739684979, 58.0739684979, 57.8582407059, 57.8367294722, 57.582307283, 57.7639043439]
grb190407788Ex90Ave = statistics.mean(grb190407788Ex90)
grb190407788Ex50 = [95.1075546321, 95.0590004058, 95.069934546, 94.794141491, 95.1156949319, 95.0052482579]
grb190407788Ex50Ave = statistics.mean(grb190407788Ex50)

grb190420981Ex90 = [78.9189782209, 78.9347588971, 79.0624982419, 79.1015907893, 78.8601544349, 78.9680838613]
grb190420981Ex90Ave = statistics.mean(grb190420981Ex90)
grb190420981Ex50 = [144.196384024, 143.53257576, 143.955000619, 143.929941906, 143.854410956, 143.668717867]
grb190420981Ex50Ave = statistics.mean(grb190420981Ex50)

grb190427AEx90 = [125.290661493, 125.162669452, 125.23363378, 125.185202361, 125.186835581, 125.230840673]
grb190427AEx90Ave = statistics.mean(grb190427AEx90)
grb190427AEx50 = [167.421552379, 168.385586992, 165.023221877, 166.824095138, 167.298456604, 165.772849882]
grb190427AEx50Ave = statistics.mean(grb190427AEx50)

grb190504678Ex90 = [84.7970065683, 85.6394057924, 74.9306450764, 83.8168216099, 84.4453804373, 84.4733882894]
grb190504678Ex90Ave = statistics.mean(grb190504678Ex90)
grb190504678Ex50 = [130.968184656, 141.978022816, 114.17174205, 127.188891061, 130.128475765, 130.424610977]
grb190504678Ex50Ave = statistics.mean(grb190504678Ex50)

grb190505051Ex90 = [59.2650693324, 58.9938460961, 58.8761077617, 59.1041681574, 59.2424362519, 58.983036454]
grb190505051Ex90Ave = statistics.mean(grb190505051Ex90)
grb190505051Ex50 = [90.8523804074, 90.0808373656, 90.2551729781, 91.0024951644, 90.9480688876, 90.1013151282]
grb190505051Ex50Ave = statistics.mean(grb190505051Ex50)

grb190510430Ex90 = [140.788006414, 140.672076357, 146.615053051, 140.723804459, 139.507397903, 146.893801366]
grb190510430Ex90Ave = statistics.mean(grb190510430Ex90)
grb190510430Ex50 = [204.368585557, 204.60417658, 204.491964182, 203.917170216, 201.605975919, 204.397186686]
grb190510430Ex50Ave = statistics.mean(grb190510430Ex50)

grb190525032Ex90 = [175.666156463, 176.289669494, 179.220402909, 176.375084822, 176.303664093, 176.125667288]
grb190525032Ex90Ave = statistics.mean(grb190525032Ex90)
grb190525032Ex50 = [248.274677669, 248.087036138, 251.406929983, 248.454198727, 248.052331468, 247.555019585]
grb190525032Ex50Ave = statistics.mean(grb190525032Ex50)

grb190531568Ex90 = [35.0456329094, 35.0743163292, 35.1358308549, 35.0397784944, 35.037751305, 35.0042293797]
grb190531568Ex90Ave = statistics.mean(grb190531568Ex90)
grb190531568Ex50 = [81.4922076577, 81.5613669226, 81.564405448, 81.6078477463, 81.6083137856, 81.5909433837]
grb190531568Ex50Ave = statistics.mean(grb190531568Ex50)

grb190601325Ex90 = [140.00708691, 140.337347994, 165.402512783, 164.659130229, 139.803252806, 165.287503212]
grb190601325Ex90Ave = statistics.mean(grb190601325Ex90)
grb190601325Ex50 = [209.563141145, 203.459023376, 216.845688259, 216.872718702, 209.253849518, 216.642409649]
grb190601325Ex50Ave = statistics.mean(grb190601325Ex50)

grb190610AEx90 = [47.0337110827, 47.1246822252, 47.0478595917, 47.0023691352, 47.1449571779, 47.0767943548]
grb190610AEx90Ave = statistics.mean(grb190610AEx90)
grb190610AEx50 = [76.8327247615, 76.9949609029, 77.0208069499, 76.8028523793, 76.8963655462, 77.1317001995]
grb190610AEx50Ave = statistics.mean(grb190610AEx50)

grb190610834Ex90 = [58.5210670071, 58.6285952842, 56.0169730722, 56.0806722495, 58.2647814324, 56.0490345085]
grb190610834Ex90Ave = statistics.mean(grb190610834Ex90)
grb190610834Ex50 = [95.6078055509, 95.4941694612, 95.2606717454, 95.2822389402, 95.423131478, 95.3991233954]
grb190610834Ex50Ave = statistics.mean(grb190610834Ex50)

# Lists of information with all GRBs
name = ["GRB190407788", "GRB190420981", "GRB190427A", "GRB190504678", "GRB190505051", "GRB190510430", "GRB190525032", "GRB190531568", "GRB190601325", "GRB190610A", "GRB190610834"]
antenna1Best = [0.919, 0.772, 0.983, 0.946, 0.525, 0.582, 0.813, 0.726, 0.690, 0.302, 0.880]
antenna2Best = [0.506, 0.720, 0.504, 0.315, 0.500, 0.500, 0.651, 0.467, 0.523, 0.202, 0.511]
exclu90Ave = [grb190407788Ex90Ave, grb190420981Ex90Ave, grb190427AEx90Ave, grb190504678Ex90Ave, grb190505051Ex90Ave, grb190510430Ex90Ave, grb190525032Ex90Ave, grb190531568Ex90Ave, grb190601325Ex90Ave, grb190610AEx90Ave, grb190610834Ex90Ave]
exclu50Ave = [grb190407788Ex50Ave, grb190420981Ex50Ave, grb190427AEx50Ave, grb190504678Ex50Ave, grb190505051Ex50Ave, grb190510430Ex50Ave, grb190525032Ex50Ave, grb190531568Ex50Ave, grb190601325Ex90Ave, grb190610AEx50Ave, grb190610834Ex50Ave]

# Plots
fig90, ax90 = plt.subplots()
ax90.scatter(antenna1Best, exclu90Ave)
ax90.set(xlabel='antenna Factors', ylabel='Exclusion Distance 90% (Mpc)',
       title='1st Best Antenna Factors vs Offtrial Exclusion Distance 90%')
ax90.grid()
plt.show()

fig90, ax90_2 = plt.subplots()
ax90_2.scatter(antenna2Best, exclu90Ave)
ax90_2.set(xlabel='antenna Factors', ylabel='Exclusion Distance 90% (Mpc)',
       title='2nd Best Antenna Factors vs Offtrial Exclusion Distance 90%')
ax90_2.grid()
plt.show()

fig50, ax50 = plt.subplots()
ax50.scatter(antenna1Best, exclu50Ave)
ax50.set(xlabel='antenna Factors', ylabel='Exclusion Distance 50% (Mpc)',
       title='1st Best Antenna Factors vs Offtrial Exclusion Distance 50%')
ax50.grid()
plt.show()

fig50, ax50_2 = plt.subplots()
ax50_2.scatter(antenna2Best, exclu50Ave)
ax50_2.set(xlabel='antenna Factors', ylabel='Exclusion Distance 50% (Mpc)',
       title='2nd Best Antenna Factors vs Offtrial Exclusion Distance 50%')
ax50_2.grid()
plt.show()